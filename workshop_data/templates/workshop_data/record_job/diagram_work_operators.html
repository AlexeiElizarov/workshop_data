{% extends 'main.html' %}
{% load recordjob_tag %}
{% load static %}

{% block title %}
    Все записи
{% endblock title %}



{% block content %}
    <div style="display: none" id="jsonData" data-json="{{ data }}"></div>
    <div>
        <canvas id="myChart" width="600px" height="600px">

        </canvas>
    </div>

    <script src="{% static 'js/cdnjs.cloudflare.com_ajax_libs_Chart.js_4.4.0_chart.min.js' %}"></script>
    <script src="{% static 'diagram.js' %}"></script>

    <script>
        const ctx = document.getElementById('myChart').getContext('2d');
        function loadJson(selector) {
            return JSON.parse(document.querySelector(selector).getAttribute('data-json'));
        }
        window.onload = function () {
            ctx.canvas.parentNode.style.height = '500px';
            ctx.canvas.parentNode.style.width = '500px';
            var jsonData = loadJson('#jsonData');


            var names = jsonData.map((item) => item.name);

            var norms = jsonData.map((item) => item.norm);


            console.log(names);
            console.log(norms);

            new Chart(ctx, {
                type: 'bar',
                data: {
                labels: names,
                datasets: [{
                    label: 'Операторы',
                    data: norms[detail__parameters_for_spu__norm__sum],
                    borderWidth: 1
                }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        },
                    maintainAspectRatio: false,
                    }
                }
            });
            };
    </script>

{% endblock content %}
'doughnut'
'bar'